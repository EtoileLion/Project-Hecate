<!-- Project Hecate v2.0 -->
<!-- by EtoileLion -->
<!-- Game System Copyright Margaret Krohn, used with permission. -->
<input type='hidden' name='attr_sheet_opened'>
<input type='hidden' class='isconfig' name='attr_isconfig' value="0">
<input type='hidden' class='sheettype' name='attr_sheettype' value="witch">
<div class='witch'>
	<input type='hidden' class='witchpage' name='attr_witchpage' value="1">	
	<div class='page1 page'>
		    <div class='header'>
	    <div class='flexcontainer'>
		<input type='text' name='attr_character_name' class='name flex' placeholder="Character Name" data-i18n-placeholder="charactername">
		<div class='head-img'></div>
		<div class='pagetogglediv'>	
			<label class='pfcontainer'>
				<input name='attr_witchpage'  type='radio' value="1" checked>
				<span class="pfradio">i
				</span>
			</label>
			<label class='pfcontainer'>
				<input name='attr_witchpage' type='radio' value="2" >
				<span class="pfradio">S
				</span>		
			</label>
			<label class='pfcontainer'>
				<input type='checkbox' name='attr_isconfig'>
				<span class="pfradio">y
				</span>		
			</label>			
			</div>
		</div>		
	</div>
	
		<p class='witchnum'>
			<span data-i18n="witch-witchnolabel">Witch #</span>
			<input type='number' name='attr_witchnumber' min=1 value=1><br>
			<button type='roll' value="&{template:rr} {{result=[[2d8+?{'Modifier/Penalty?'|0}]]}} {{roll_name=2d8}} {{name=@{character_name}}} ">Roll 2d8</button>
		</p>		
		<h2>About Me</h2>		
		<div class='sheet-2colrow'>
			<div class='sheet-col'>
				<span data-i18n="physically">Physically</span><br />
				<input type='text' name='attr_witchphysadj1' data-i18n-placeholder="adjective">
				<input type='text' name='attr_witchphysadj2'  data-i18n-placeholder="adjective">
			</div>
			<div class='sheet-col'>
				<span data-i18n="hair">Hair</span><br><input type='text' name='attr_witchhair' data-i18n-placeholder="adjective"><br> <span data-i18n="eyes">Eyes</span><br><input type='text' name='attr_witcheyes' data-i18n-placeholder="adjective">
			</div>
		</div>
		<div class='sheet-3colrow'>
			<div class='sheet-col'>
				<span data-i18n="personality">Personality</span>
				<fieldset class='repeating_personality'>
					<input type='hidden' name='attr_witchpershide'>
					<input type='text' name='attr_witchpersadj' data-i18n-placeholder="adjective">
				</fieldset>
			</div>			
			<div class='sheet-col'>
				<span data-i18n="like">Likes</span>
				<fieldset class='repeating_likes'>
					<input type='hidden' name='attr_witchlikehide'>		
					<input type='text' name='attr_witchlike'>
				</fieldset>			
			</div>
			<div class='sheet-col'>
				<span data-i18n="hate">Hates</span>
				<fieldset class='repeating_hates'>
					<input type='hidden' name='attr_witchhatehide'>		
					<input type='text' name='attr_witchhate'>
				</fieldset>					
			</div>
		</div>
		<hr>
		<h2>My School</h2>
		<div class='flexrow'>
			<span data-i18n="favoriteprofis">Favorite Professor</span>&nbsp;<input type='text' name='attr_favprof'  data-i18n-placeholder="professor">&nbsp;<span data-i18n="because">because</span>&nbsp;<input type='text' name='attr_favprofreason' data-i18n-placeholder="reason" class='flexfield'>
		</div>
		<div class='flexrow'>
			<span data-i18n="favoriteplaceis">My favorite place in the school is</span>&nbsp;<input type='text' name='attr_favloc' data-i18n-placeholder="location">&nbsp;<span data-i18n="because">because</span>&nbsp;<input type='text' name='attr_favlocreason' data-i18n-placeholder="reason" class='flexfield'>
		</div>
		<div class='flexrow'>
			<input type='text' name='attr_favfriend' data-i18n-placeholder="student">&nbsp;<span data-i18n="bffbecause">is my best friend because</span>&nbsp;<input type='text' name='attr_favfriendreason' data-i18n-placeholder="reason" class='flexfield'>
		</div>
		<div class='flexrow'>
			<span data-i18n="worriedabout">I'm worried about</span>&nbsp;<input type='text' name='attr_favworry' data-i18n-placeholder="student">&nbsp;<span data-i18n="because">because</span>&nbsp;<input type='text' name='attr_favworryreason' data-i18n-placeholder="reason" class='flexfield'>
		</div>
		<div class='flexrow'>
			<span data-i18n="admire">I admire</span>&nbsp;<input type='text' name='attr_favadmire' data-i18n-placeholder="student">&nbsp;<span data-i18n="because">because</span>&nbsp;<input type='text' name='attr_favadmirereason' data-i18n-placeholder="reason" class='flexfield'>
		</div>
		<hr>
		<h2>My Family</h2>
		<div>
			<span data-i18n="familyis">My family is</span>&nbsp;<input type='text' name='attr_famadj1' data-i18n-placeholder="adjective">,&nbsp;<input type='text' name='attr_famadj2' data-i18n-placeholder="adjective">,&nbsp;<span data-i18n="and">and</span>&nbsp;<input type='text' name='attr_famadj3' data-i18n-placeholder="adjective">.
		</div>
		<div class='flexrow'>
			<span data-i18n="closesttomy">I am closest to my</span>&nbsp;<input type='text' name='attr_famclose' data-i18n-placeholder="fammember">&nbsp;<span data-i18n="because">because</span>&nbsp;<input type='text' name='attr_famclosereason' data-i18n-placeholder="reason" class='flexfield'>
		</div>
		<div>
			<span data-i18n="houseis">My house is</span>&nbsp;<input type='text' name='attr_houseadj1' data-i18n-placeholder="adjective">,&nbsp;<input type='text' name='attr_houseadj2' data-i18n-placeholder="adjective">,&nbsp;<span data-i18n="and">and</span>&nbsp;<input type='text' name='attr_houseadj3' data-i18n-placeholder="adjective">
		</div>
		<div class='flexrow'>
			<span data-i18n="favoritehouseplaceis">My favorite place in my house is</span>&nbsp;<input type='text' name='attr_houseloc' data-i18n-placeholder="location">&nbsp;<span data-i18n="because">because</span>&nbsp;<input type='text' name='attr_houselocreason' data-i18n-placeholder="reason" class='flexfield'>
		</div>
	</div>
    <div class='page2 page'>
		    <div class='header'>
	    <div class='flexcontainer'>
		<input type='text' name='attr_character_name' class='name flex' placeholder="Character Name" data-i18n-placeholder="charactername">
		<div class='head-img'></div>
		<div class='pagetogglediv'>	
			<label class='pfcontainer'>
				<input name='attr_witchpage'  type='radio' value="1" checked>
				<span class="pfradio">i
				</span>
			</label>
			<label class='pfcontainer'>
				<input name='attr_witchpage' type='radio' value="2" >
				<span class="pfradio">S
				</span>		
			</label>
			<label class='pfcontainer'>
				<input type='checkbox' name='attr_isconfig'>
				<span class="pfradio">y
				</span>		
			</label>			
			</div>
		</div>		
	</div>	
		<h2>My Spellbook</h2>
		<p>
			<span data-i18n="myspellbookis">My spellbook is</span> <input type='text' name='attr_spellbookadj1'  data-i18n-placeholder="adjective"> and  <input type='text' name='attr_spellbookadj2'  data-i18n-placeholder="adjective">
		</p>
		<fieldset class='repeating_spells'>
			<input type='hidden' name='attr_witchspellhide'>
		    <div class='buttonrow'>
				<div>
					<input type='hidden' name='attr_hidespell' class='hidespellcb' value="on">			    
					<button type='roll' value="&{template:aw} {{result=[[2d8+@{level}+?{'Modifier/Penalty?'|0}]]}} {{roll_name=@{spellname}}} {{name=@{character_name}}} ">
						<button type='roll' class='squawk hidespell' value="&{template:squawk} {{spellname=@{spellname}}} {{desc=@{desc}}} {{label=Level @{level}}}">
						</button>
					</button>			
				</div>
				<div>
					<label data-i18n="spellname">Name</label><input type='text' name='attr_spellname'>			
				</div>
				<div>
					<label data-i18n="spelllevel">Level</label>
					<input type='number' name='attr_level' min=1 value=1>
					<input type='checkbox' name='attr_hidespell' class='hidespellcb' checked>
				</div>
			</div>
			<input type='hidden' name='attr_hidespell' class='hidespellcb' value="on">
			<div class='descrow'>
				<div>
					<button type='roll' class='squawk' value="&{template:squawk} {{spellname=@{spellname}}} {{desc=@{desc}}} {{label=Level @{level}}}">
					</button>
				</div>
				<div>
					<label data-i18n="spelldesc">Spell Description</label>
				</div>
				<textarea name='attr_desc'>
				</textarea>
			</div>			
			<div class='sheet-2colrow castsrow'>
				<div class='sheet-col'>
					<label data-i18n="spellsuccs">Successful Casts</label><br>
					<input type='checkbox' name='attr_successcast1'>
					<input type='checkbox' name='attr_successcast2'>
					<input type='checkbox' name='attr_successcast3'>
				</div>
				<div class='sheet-col'>
					<label data-i18n="spellfails">Failed Casts</label><br>
					<input type='checkbox' name='attr_failcast1'>
					<input type='checkbox' name='attr_failcast2'>
					<input type='checkbox' name='attr_failcast3'>
					<input type='checkbox' name='attr_failcast4'>
					<input type='checkbox' name='attr_failcast5'>
				</div>
			</div>
		</fieldset>
	</div>
	
</div>
<div class='school'>
	<div class='header'>
		<input type='text' name='attr_character_name' placeholder="Character Name" data-i18n-placeholder="charactername">
		<div class='head-img'></div>
		<div class='pagetogglediv'>	
			<label class='pfcontainer'>
				<input type='checkbox' name='attr_isconfig'>
				<span class="pfradio">y
				</span>		
			</label>
		</div>		
	</div>
	<p>
		<span data-i18n="school-wegoto">We go to </span>
		<input type='text' name='attr_schoolname'>, <span data-i18n="school-schoolof">the School of</span> <input type='text' name='attr_schoolnoun' placeholder="(Noun)" data-i18n-placeholder="noun">
	</p>
	<p>
		<span data-i18n="school-desc">Our school is </span>
		<fieldset class='repeating_schooladjs'>
			<input type='text' name='attr_schooladj'  placeholder="(Adjective)" data-i18n-placeholder="adjective">
		</fieldset>
	</p>
	<p>
		<span data-i18n="school-spellsfor">We use our spells to</span> <input type='text' name='attr_schoolverb' data-i18n-placeholder="verb" placeholder="(Verb)">
	</p>
	<p>
		<span data-i18n="school-an">A[n]</span> <input type='text' name='attr_schoolhwadj' data-i18n-placeholder="adjective" placeholder="(Adjective)"> <span data-i18n="has">has</span> <input type='text' name='attr_schoolhwnoun' placeholder="(Noun)" data-i18n-placeholder="noun">  <input type='text' name='attr_schoolhwverb' data-i18n-placeholder="verb" placeholder="(Verb)"> <span data-i18n="school-ourschool">our school.</span>
	</p>
	<h2 data-i18n="school-faculty">Faculty</h2>
	<hr>
	<div class='faculty'>
		<fieldset class="repeating_professors">
			<input type='hidden' class='modifyprof' name='attr_modifyprof' value='on'>
			<div>
				<h2><span data-i18n="professor">Professor</span> <span name='attr_profname'></span> (<span name='attr_profpronoun'></span>) <input type='checkbox' name='attr_modifyprof' checked></h2>
			</div>
			<div class='sheet-2colrow'>
				<div class='sheet-col'><span data-i18n="teaches">Teaches</span><br><span name="attr_schoolclass"></span>
				</div>
				<div class='sheet-col'><span data-i18n="attributes">Attributes</span><br><span name="attr_profadj1"></span>,<span name="attr_projadj2"></span>
				</div>
				
			</div>
			<p>
				<span data-i18n="school-professor">Professor</span>
			<input type='text' name='attr_profname' placeholder="(Name)" data-i18n-placeholder="name"> <span data-i18n="school-teaches">teaches</span> <input type='text' name='attr_schoolclass' placeholder="(Class Name)"  data-i18n-placeholder="classname">.</p>
			<p>
				<input type='text' name='attr_profpronoun' data-i18n-placeholder="pronoun" placeholder="(Pronoun)">&nbsp;<span data-i18n="school-are">are</span>&nbsp;<input type='text' name='attr_profadj1' placeholder="(Adjective)" data-i18n-placeholder="adjective">, <span data-i18n="and">and</span> <input type='text' name='attr_projadj2' placeholder="(Adjective)" data-i18n-placeholder="adjective">.<br> <input type='checkbox' name='attr_modifyprof' checked>
			</p>		
		</fieldset>
	</div>
</div>
<div class='page3'>	
	<div class='header'>
		<div class='pagetogglediv'>	
			<label class='pfcontainer'>
				<input type='checkbox' name='attr_isconfig'>
				<span class="pfradio">y
				</span>		
			</label>
		</div>
	</div>
	<p>
		<span data-i18n="sheetisa">This sheet is a</span> <select name='attr_sheettype'>
			<option value='witch' selected  data-i18n="witch">Witch</option>
			<option value='school' data-i18n="school">School</option>
		</select>
	</p>
</div>
<rolltemplate class="sheet-rolltemplate-aw">
	<table>
		<tr>
			<th colspan="2">{{name}} casts<br>
				<i>{{#roll_name}}{{roll_name}}{{/roll_name}}{{#roll_mod}}{{roll_mod}}{{/roll_mod}}</i>
			</th>
		</tr>
		<tr>
			{{#rollGreater() result 17}}
			<td class="result success">{{result}}</td>
			<td>Critical Success</td>
			{{/rollGreater() result 17}}
			{{#rollBetween() result 13 17}}
			<td class="result success">{{result}}</td>
			<td>Success</td>
			{{/rollBetween() result 13 17}}			
			{{#rollBetween() result 10 12}}
			<td class="result">{{result}}</td>
			<td>Partial Success</td>
			{{/rollBetween() result 10 12}}
			{{#rollBetween() result 2 9}}
			<td class="result failure">{{result}}</td>
			<td>Failure</td>
			{{/rollBetween() result 2 9}}
			{{#rollLess() result 2}}
			<td class="result failure">{{result}}</td>
			<td class="failure">Critical Failure</td>
			{{/rollLess() result 2}}
		</tr>
	</table>
</rolltemplate>
<rolltemplate class="sheet-rolltemplate-rr">
	<table class="{{#rollGreater() result 12}}
			success
			{{/rollGreater() result 12}}
			{{#rollLess() result 10}}
			failure
			{{/rollLess() result 10}}">
		<tr>
			<th colspan="2">{{name}} rolls<br>
				<i>{{#roll_name}}{{roll_name}}{{/roll_name}}{{#roll_mod}}{{roll_mod}}{{/roll_mod}}</i>
			</th>
		</tr>
		<tr>
			{{#rollGreater() result 17}}
			<td class="result success">{{result}}</td>
			<td>Critical Success</td>
			{{/rollGreater() result 17}}
			{{#rollBetween() result 13 17}}
			<td class="result success">{{result}}</td>
			<td>Success</td>
			{{/rollBetween() result 13 17}}			
			{{#rollBetween() result 10 12}}
			<td class="result">{{result}}</td>
			<td>Partial Success</td>
			{{/rollBetween() result 10 12}}
			{{#rollBetween() result 2 9}}
			<td class="result failure">{{result}}</td>
			<td>Failure</td>
			{{/rollBetween() result 2 9}}
			{{#rollLess() result 2}}
			<td class="result failure">{{result}}</td>
			<td class="failure">Critical Failure</td>
			{{/rollLess() result 2}}
		</tr>
	</table>
</rolltemplate>
<rolltemplate class="sheet-rolltemplate-squawk">
	<table class='squawkbox'>
		<tr>
			<th colspan="2"><span>{{spellname}}</span>{{#label}}<br>
			<i>({{label}})</i>{{/label}}</th>
		</tr>
		<tr>
			<td>
				{{desc}}
			</td>
		</tr>
	</table>	
</rolltemplate>

<script type='text/worker'>
	"use strict";
	on("sheet:opened", function (eventInfo) {
		getAttrs(['sheet_opened'],function (values) {
			const opened = values.sheet_opened*1||0;
			if(opened !== 0) return;
			const settings = {"sheet_opened":1};
			settings["repeating_hates_"+generateRowID()+"_witchhate"] = "(Noun)";
			settings["repeating_likes_"+generateRowID()+"_witchlike"] = "(Noun)";
			settings["repeating_spells_"+generateRowID()+"_hidespell"] = "on";
			settings["repeating_hates_"+generateRowID()+"_witchhate"] = "(Verb)";
			settings["repeating_likes_"+generateRowID()+"_witchlike"] = "(Verb)";				
			settings["repeating_spells_"+generateRowID()+"_hidespell"] = "on";
			settings["repeating_personality_"+generateRowID()+"_witchpershide"] = 1;
			settings["repeating_personality_"+generateRowID()+"_witchpershide"] = 1;			
			settings["repeating_personality_"+generateRowID()+"_witchpershide"] = 1;
			setAttrs(settings);
			console.log("Initiated Repeater Fields");
			console.log(settings);
		});
	});
	
	// Name formatter for School.
	on("change:schoolnoun change:schoolname", function(eventInfo) {
		getAttrs(["sheettype","schoolnoun","schoolname"], function (values) {
			if(values.sheettype == "school") {
				if(values.hasOwnProperty("schoolname") && values.schoolname != "") {
					if(values.hasOwnProperty("schoolnoun") && values.schoolnoun != "") {
						setAttrs({'character_name': values.schoolname+", School of "+values.schoolnoun});
						} else {
						setAttrs({'character_name': values.schoolname});
					}
					} else if(values.hasOwnProperty("schoolnoun") && values.schoolnoun != "") {
					setAttrs({'character_name': "The School of "+values.schoolnoun});				
				}
			}
		});
	});
</script>  		
